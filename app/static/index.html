<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AfriCredit Risk Engine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="card">
    <h2>AFRICREDIT DASHBOARD</h2>
    <form id="loanForm">
        <label>Age</label>
        <input type="number" id="age" value="30" required>

        <label>Credit Amount (Currency)</label>
        <input type="number" id="credit_amount" value="5000" required>

        <label>Duration (Months)</label>
        <input type="number" id="duration" value="12" required>

        <label>Residence Since (Years)</label>
        <input type="number" id="residence_since" value="2" required>

        <label>Installment Rate (1-4)</label>
        <input type="number" id="installment_commitment" value="3" required>

        <label>Existing Credits</label>
        <input type="number" id="existing_credits" value="1" required>

        <label>Dependents</label>
        <input type="number" id="num_dependents" value="1" required>

        <button type="submit">Analyze Risk</button>
    </form>

    <div id="result"></div>
</div>

<script>
    document.getElementById('loanForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // 1. Gather data from the form
        const formData = {
            age: parseInt(document.getElementById('age').value),
            credit_amount: parseFloat(document.getElementById('credit_amount').value),
            duration: parseInt(document.getElementById('duration').value),
            residence_since: parseInt(document.getElementById('residence_since').value),
            installment_commitment: parseInt(document.getElementById('installment_commitment').value),
            existing_credits: parseInt(document.getElementById('existing_credits').value),
            num_dependents: parseInt(document.getElementById('num_dependents').value)
        };

        // 2. Send data to our API
        const response = await fetch('/predict', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });

        const result = await response.json();
        
        // 3. Display Result
        const resultDiv = document.getElementById('result');
        resultDiv.style.display = 'block';
        resultDiv.className = result.prediction === 0 ? 'risk' : 'safe';
        
        if (result.risk_assessment === "Low Risk") {
            resultDiv.className = 'safe';
            resultDiv.innerHTML = `APPROVED <br> Probability of approval: ${result.approval_probability}`;
        } else {
            resultDiv.className = 'risk';
            resultDiv.innerHTML = `REJECTED <br> High Risk Detected`;
        }
    });
</script>

</body>
</html>